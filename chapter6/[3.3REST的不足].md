# REST的不足

作为架构风格，随着团队或者组织业务的不断增长，服务器端响应内容复杂度的增加，REST的使用面临如下两个问题：

  - 如何标准化响应结构体
  - 如何有效处理相关资源的链接

  ## 标准化响应结构体

     我们知道，使用REST，可以将业务场景的具体信息定义为资源，并基于JSON或者其他格式，返回给客户端。随着业务的不断增长，逻辑的增加，服务器端对内容的响应结构会变得越来越复杂（所谓响应结构，就是指服务器端的响应内容的结构）。
  
      REST作为指导性的原则，并没有定义服务器端响应结构应该遵循什么标准。这也就意味着，在企业内部，不同的部门，不同的开发小组，所定义的响应格式可能不尽相同；譬如，如下是服务器端对客户端发送获取产品请求的的响应结果，两种结构都是合理的，但存在着明显的差异：

      ### 响应结构一：
```      
{
  "name":"Domain Driver Design",
  "category": "IT Books",
  "price":120.00,
  "ref": "http://xxxx/products/12",
  "created_at": "2015-05-01 10:00:00",
  "updated_at": "2015-06-01 11:00:00"
}

```

      ### 响应结构二：
```
{
  "basic_info":{
    "name":"Domain Driver Design",
    "price":120.00,
    "category":"IT Books"
  },

  "ref":{
    "self": "http://xxxx/product/12”,
    “list": "http://xxxx/products&page=1"
  },

  "timestamp":{
    "created_at": "2015-05-01 10:00:00",
    "updated_at": "2015-06-01 11:00:00"
  }
}
```

因此，如何在组织内部定义一套标准的响应结构，成了组织扩张后使用REST面临的一个问题。
     
## 如何有效处理相关资源的链接

大部分REST的实现，都是基于JSON作为传输格式，但JSON最大的遗憾，正如W3C所描述的：

    >

    JSON has no built-in support for hyperlinks, which are a fundamental building block on the Web.
   
    >

    JSON最大的遗憾在于没有对超链接处理做内置的支持，而这部分是恰恰是WEB的基石。

这带来的潜在问题是，对于一个调用API接口的消费者而言，必须得通过查看相关的文档，才能了解如何修改资源的状态，或者获取与当前资源相关联的资源信息。

譬如，某些社交系统可能会提供类似如下的API文档列表，来帮助消费者了解如何使用其API。

```
https://api.example.com/users/1234567890                 GET 获取用户明细
https://api.example.com/users/[ID]/friends               GET 获取用户相关的好友
https://api.example.com/users/[ID]/posts                 GET 获取用户相关的文章
```

如上面的表格所示，获取某用户信息的请求可能如下：
```GET https://api.example.com/user/1234567890```
```
{
   "id": "1234567890",
   "name": “张三”,
    "age" : 25, 
    “group”:[
         {“name”: “Fishing”,   “created_at”: “2015-05-20 20:00:00”},
         {“name”: “Cooking”, “created_at”: “2015-05-10 20:00:00"}
    ],
}
```

而获取某用户朋友列表的请求可能为：
```GET https://api.example.com/user/1234567890/friends```
```
[
    {
        “id": “1895638109",
        “name": “李四",
        "age" : 30, 
   },
   {
       “id": "8371023509",
       "name": "马丁",
       "age" : 40, 
   }
]
```

实际上，对于用户而言，获取其朋友列表的资源应该是和该用户的资源相关的，即用户信息的API返回的JSON结果应该能够自解释这种资源的关系。

因此，如何用有效的方式管理REST中资源和其他资源的依赖以及链接，是否能够将这种方式标准化，也成为用好REST一个重要的因素。

#### 总结
         
 通过REST，我们能够从抽象层面将响应定义为资源，并使用HTTP协议的标准动作映射为对资源的操作。
但是对于实现层面而言，我们依然需要考虑如何定义响应格式，如何处理与当前资源相关资源的引用。随着业务的复杂度增加以及实现的服务数量的增加，这个问题可能愈发重要。
因此，是否存在一种方式，能帮助我们在享受REST原则的同时，能帮助我们解决这两个问题呢。